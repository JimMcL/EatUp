<html>
  <head>
    <title>Eat up</title>
    <link href="trial.css" rel="stylesheet">
    <script src="trial.js"></script>
    <script src="logger.js"></script>
    <script src="mfb.js"></script>
    <script src="user.js"></script>
    <script src="setup.js"></script>
    <script language="javascript">

      function sendEmail(e) {
          var emailAddress = document.getElementById("email").value;
          if (emailAddress) {
              // Get the data logger
              let logger = ChooseLogger();
              // Use same sessionId if possible
              let sessionId = getCookie("sessionId");
              if (sessionId)
                  logger.sessionId = sessionId;
              // Log the email address
              logger.logUserEmail(emailAddress);
              // Show thanks message and hide the email form
              document.getElementById("thanks").style.display = "";
              document.getElementById("emailBlock").style.display = "none";
          }
          // Don't submit the form to a server
          return false;
      }

      // Displays the uer's total time taken
      function showTime(time) {
          var elems = document.body.querySelectorAll(".showtime");
          for (let elem of elems) {
              elem.innerHTML = (time / 1000).toFixed(1);
          }
      }

      // Displays the appropriate block depending on whether the user made any obvious mistakes
      // function showAppropriateResult(allGood) {
      //     document.getElementById("good").style.display = allGood ? "block" : "none";
      //     document.getElementById("bad").style.display = allGood ? "none" : "block";
      // }
      
      // ---- Startup function ----

      window.onload = function(e){
          document.getElementById("email").focus();
          document.getElementById("emailForm").onsubmit = sendEmail;
      }

    </script>
  </head>
  <body id="finish">
    <div id="watermark" style="display:none">
      <div class="text">DEBUG ONLY</div>
    </div>

    <h1>Eat up</h1>

    <p>
      Thanks for participating!

    <!-- <p class="result" id="good"> -->
    <!--   You finished in <span class="label"><span class="showtime">1000</span> seconds!</span> Well done! -->
    <!-- <p class="result" id="bad"> -->
    <!--   You finished in <span class="showtime">1000</span> seconds, however you made <span class="label">too many mistakes!</span> -->
    <!--   Why don&apos;t you <a href="index.html" class="button">Try again?</a> -->
      <!-- </p> -->

    <p>You scored <span id="numRight" class ="label"></span>
      out of
      <span id="numTotal" class="label"></span> in <span class="label"><span class="showtime">1000</span> seconds!</span> Well done!</p>

    <div id="emailBlock">
      <p>If you would like to be notified of the outcome of this research, please leave your email address below.
        If you choose to supply your email address, we will not use it for any other purpose, nor will we supply it to any third party.

        <form id="emailForm">
          Email: <input type="email" id="email">
          <input id="submit" type="submit" value="Submit" class="button">
        </form>

    </div>
    <p class="thanks" id="thanks" style="display:none">Thanks, we'll be in touch!

    <p><a href="index.html" class="button">Try again</a>

      <h2>Photo Credits</h2>
    <p>
      We would like to warmly thank the many people who have
      generously allowed us to use their wonderful photos of spiders and
      insects. Copyright is retained by the respective photographers.
    </p>
    <p>Photographers, in no particular order...
      <ul>
        <li> Nick Monaghan <a href="www.lifeunseen.com">www.lifeunseen.com</a></li>
        <li> Nicholas Fisher</li>
        <li> Alex Wild</li>
        <li> Greg Anderson</li>
        <li> Tom Murray</li>
        <li> Nicky Bay: Please refer to <a href="https://www.nickybay.com">https://www.nickybay.com</a> for online usage.</li>
        <li> Msc. Jos&eacute; Miguel D&iacute;az Miranda</li>
        <li> Jay Barnes: <a href="https://bugguide.net/user/view/1291">BugGuide user page</a></li>
        <li> Lisa Bentley</li>
        <li> Robert Whyte</li>
        <li> Iain Macaulay</li>
        <li> Mark Helle</li>
        <li> Flickr user <a href="https://www.flickr.com/photos/22783863@N07/">Sankax</a> </li>
        <li> Jim McLean</li>
      </ul>
    </p>
    
      <!-- ==================================================================== -->
      <!-- The core Firebase JS SDK is always required and must be listed first -->
      <script src="https://www.gstatic.com/firebasejs/5.11.1/firebase-app.js"></script>
      <!-- <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-auth.js"></script> -->
      <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase-database.js"></script>
      <script>
        InitFirebase();
      </script>
      <!-- ==================================================================== -->

  </body>
  <script language="javascript">
    showTime(getCookie("totalTime"));
    var total = getCookie("totalScored");
    var errors = JSON.parse(getCookie("errors"));
    document.getElementById("numRight").innerText = total - errors.length;
    document.getElementById("numTotal").innerText = total + 0;
    //showAppropriateResult(getCookie("numBadMistakes") == 0);
  </script>
</html>
